{% extends 'base/base.html' %}
{% block nav_dashboard %}
{% if not my_shares %}
    class="active"
{% endif %}
{% endblock %}


{% block nav_my_share%}
{% if my_shares %}
    class="active"
{% endif %}
{% endblock %}

{% load static %}

{% block title %}
Eudaimonia | Your Dashboard
{% endblock %}

{% block body %}
<link rel="stylesheet" href="{% static 'dashboard/dashboard.css' %}">

<body id="dashboard">
    <div class="dashboard-container">
        <div class="dashboard-nav">
            <form id="search" method="post">
                {% csrf_token %}
                {{ form.search }}
                <button class="search-button"   type="submit"><i class="ri-search-line"></i></button>
            </form>
            
            <div class="mini-nav">
                <a href="{% url 'dashboard' %}" style="color: #301dad;"><i class="ri ri-dashboard-line"></i></a>
                <a {% block nav_share%}{% endblock %} href="{% url 'share' %}"><i class="ri ri-add-box-line"></i></a>
                <a {% block nav_story%}{% endblock %} href="{% url 'my_share' %}"><i class="ri ri-stack-line"></i></a>
            </div>

            <br /><br /><br />
        </div>
        <div class="infinite-container">
                    {% for post in page_obj %}
                    <div onload="getHeight(this)" class="infinite-item">
                        <a href="{% url 'story' id=post.id %}">
                            <h2>{{ post.title }}</h2>
                        </a>
                        <h5>{{ post.date }}</h5>
                        <p>{{ post.post|truncatechars:1300 }} 
                            <a class="read-more" href="{% url 'story' id=post.id %}">Read more</a> </p>
                        <!--<div class="react">
                            <i onclick="liked(this)" class="ri ri-heart-line"></i>
                        </div>-->
                    </div>
                    {% endfor %}
        </div>

        <p class="loading">Loading...</p>
        <div class="column">
            {% if page_obj.has_next %}
            <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}"></a>
            {% endif %}
        </div>
    </div>
    <script src="/static/infinite scroll js/jquery.waypoints.min.js"></script>
    <script src="/static/infinite scroll js/infinite.min.js"></script>
    <script>
        var infinite = new Waypoint.Infinite({
            element: $('.infinite-container')[0],
            offset: 'bottom-in-view',
            onBeforePageLoad: function () {
                $('.loading').show();
            },
            onAfterPageLoad: function () {
                $('.loading').hide();
            }
        });
        document.getElementsByClassName("infinite-item").onclick = function () {

        }

        function getHeight(infiniteElement){

        }

        function liked(heart) {
        if (heart.classList.contains('ri-heart-line')) {
            heart.classList.remove('ri-heart-line');
            heart.classList.add('ri-heart-fill');

        }
        else {
            heart.classList.remove('ri-heart-fill');
            heart.classList.add('ri-heart-line');
        }
    }



    </script>
</body>
{% endblock %}